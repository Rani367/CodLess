<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional FLL Robotics Control Center - Advanced robot control, recording, and simulation platform">
    <meta name="keywords" content="FLL, robotics, LEGO, Pybricks, robot control, automation">
    <meta name="author" content="CodLess Robotics">
    <meta name="theme-color" content="#00a8ff">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codless-robotics.com/">
    <meta property="og:title" content="CodLess - FLL Robotics Control Center">
    <meta property="og:description" content="Professional FLL Robotics Control Center with advanced robot control, recording, and simulation capabilities">
    <meta property="og:image" content="/assets/og-image.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://codless-robotics.com/">
    <meta property="twitter:title" content="CodLess - FLL Robotics Control Center">
    <meta property="twitter:description" content="Professional FLL Robotics Control Center with advanced robot control, recording, and simulation capabilities">
    <meta property="twitter:image" content="/assets/og-image.jpg">

    <!-- PWA Support -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="assets/icon-192x192.png">
    
    <title>CodLess - FLL Robotics Control Center v3.0.0</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="app.js" as="script">
    <link rel="preload" href="styles.css" as="style">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-robot"></i>
            </div>
            <h2>CodLess Robotics</h2>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p>Initializing Control Center...</p>
        </div>
    </div>

    <!-- Main Application -->
    <div class="app-container" id="appContainer" style="display: none;">
        <div class="title-bar">
            <div class="title-content">
                <i class="fas fa-robot" aria-hidden="true"></i>
                <h1>CodLess - FLL Robotics Control Center</h1>
                <span class="version-badge">v3.0.0</span>
            </div>
            <div class="window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeWindow()" aria-label="Minimize window">
                    <i class="fas fa-minus" aria-hidden="true"></i>
                </button>
                <button class="window-btn maximize-btn" onclick="toggleMaximize()" aria-label="Toggle fullscreen">
                    <i class="fas fa-expand" aria-hidden="true"></i>
                </button>
                <button class="window-btn close-btn" onclick="closeWindow()" aria-label="Close application">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
        </div>

        <div class="main-container">
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="section-header">
                        <i class="fas fa-wifi" aria-hidden="true"></i>
                        <h3>Hub Connection</h3>
                    </div>
                    <div class="section-content">
                        <button id="connectBtn" class="btn btn-primary" aria-describedby="hubStatus">
                            Connect to Pybricks Hub
                        </button>
                        <div class="checkbox-container">
                            <input type="checkbox" id="developerMode" class="checkbox" aria-describedby="simModeDesc">
                            <label for="developerMode">Simulation Mode</label>
                        </div>
                        <small id="simModeDesc" class="help-text">Enable to test without physical robot</small>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="section-header">
                        <i class="fas fa-cog" aria-hidden="true"></i>
                        <h3>Robot Configuration</h3>
                    </div>
                    <div class="section-content">
                        <button id="configBtn" class="btn btn-success">
                            <i class="fas fa-tools" aria-hidden="true"></i>
                            Configure Robot
                        </button>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="section-header">
                        <i class="fas fa-code" aria-hidden="true"></i>
                        <h3>Direct Hub Programming</h3>
                    </div>
                    <div class="section-content">
                        <p class="info-text">
                            Directly upload and run code on your SPIKE Prime hub without needing the Pybricks website
                        </p>
                        <button id="downloadCompetitionBtn" class="btn btn-warning">
                            <i class="fas fa-download" aria-hidden="true"></i>
                            Download Competition Code to Robot
                        </button>
                        <button id="copyCodeBtn" class="btn btn-primary">
                            <i class="fas fa-copy" aria-hidden="true"></i>
                            Copy Hub Code
                        </button>
                        <button id="openPybricksBtn" class="btn btn-secondary">
                            <i class="fas fa-external-link-alt" aria-hidden="true"></i>
                            Open Pybricks IDE
                        </button>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="section-header">
                        <i class="fas fa-play-circle" aria-hidden="true"></i>
                        <h3>Saved Runs</h3>
                    </div>
                    <div class="section-content">
                        <select id="savedRunsList" class="select-box" aria-label="Select saved run">
                            <option value="">No saved runs</option>
                        </select>
                        <div class="button-group">
                            <button id="playBtn" class="btn btn-success" disabled>
                                <i class="fas fa-play" aria-hidden="true"></i>
                                Play
                            </button>
                            <button id="deleteBtn" class="btn btn-danger" disabled>
                                <i class="fas fa-trash" aria-hidden="true"></i>
                                Delete
                            </button>
                        </div>
                        <div class="button-group">
                            <button id="exportBtn" class="btn btn-secondary" disabled>
                                <i class="fas fa-download" aria-hidden="true"></i>
                                Export
                            </button>
                            <button id="importBtn" class="btn btn-secondary">
                                <i class="fas fa-upload" aria-hidden="true"></i>
                                Import
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div id="simulatorSection" class="content-section hidden">
                    <div class="section-header">
                        <i class="fas fa-eye" aria-hidden="true"></i>
                        <h3>Robot Simulator</h3>
                        <div class="section-actions">
                            <button id="simulatorSettingsBtn" class="btn-icon" aria-label="Simulator settings">
                                <i class="fas fa-cog" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <div class="simulator-container">
                        <canvas id="robotSimulator" aria-label="Robot movement simulator"></canvas>
                        <div class="simulator-controls">
                            <div class="simulator-info">
                                <p class="info-text">Real-time visual simulation of your robot's movement and arm positions</p>
                            </div>
                            <div class="button-group">
                                <button id="uploadMapBtn" class="btn btn-primary" disabled>
                                    <i class="fas fa-upload" aria-hidden="true"></i>
                                    Upload Map
                                </button>
                                <button id="resetSimBtn" class="btn btn-success" disabled>
                                    <i class="fas fa-refresh" aria-hidden="true"></i>
                                    Reset Position
                                </button>
                                <button id="fullscreenSimBtn" class="btn btn-secondary">
                                    <i class="fas fa-expand" aria-hidden="true"></i>
                                    Fullscreen
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <i class="fas fa-microphone" aria-hidden="true"></i>
                        <h3>Recording Controls</h3>
                        <div class="section-actions">
                            <span id="recordingTimer" class="recording-timer hidden">00:00</span>
                        </div>
                    </div>
                    <div class="recording-controls">
                        <div class="input-group">
                            <label for="runNameInput">Run Name:</label>
                            <input type="text" id="runNameInput" value="Run 1" class="input-field" maxlength="50" aria-describedby="runNameHelp">
                            <small id="runNameHelp" class="help-text">Maximum 50 characters</small>
                        </div>
                        <div class="button-group">
                            <button id="recordBtn" class="btn btn-danger" disabled>
                                <i class="fas fa-circle" aria-hidden="true"></i>
                                Record Run
                            </button>
                            <button id="saveBtn" class="btn btn-success" disabled>
                                <i class="fas fa-save" aria-hidden="true"></i>
                                Save Run
                            </button>
                            <button id="pauseBtn" class="btn btn-warning hidden" disabled>
                                <i class="fas fa-pause" aria-hidden="true"></i>
                                Pause
                            </button>
                        </div>
                    </div>
                </div>



                <div class="content-section">
                    <div class="section-header">
                        <i class="fas fa-keyboard" aria-hidden="true"></i>
                        <h3>Robot Controls</h3>
                        <div class="section-actions">
                            <button id="emergencyStopBtn" class="btn btn-danger btn-emergency">
                                <i class="fas fa-stop" aria-hidden="true"></i>
                                Emergency Stop
                            </button>
                        </div>
                    </div>
                    <div class="controls-grid">
                        <div class="control-group">
                            <h4>Movement Controls</h4>
                            <div class="control-keys">
                                <div class="key-row">
                                    <div class="key-item">
                                        <kbd aria-label="W key">W</kbd>
                                        <span>Forward</span>
                                    </div>
                                </div>
                                <div class="key-row">
                                    <div class="key-item">
                                        <kbd aria-label="A key">A</kbd>
                                        <span>Turn Left</span>
                                    </div>
                                    <div class="key-item">
                                        <kbd aria-label="S key">S</kbd>
                                        <span>Backward</span>
                                    </div>
                                    <div class="key-item">
                                        <kbd aria-label="D key">D</kbd>
                                        <span>Turn Right</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="control-group">
                            <h4>Arm Controls</h4>
                            <div class="control-keys">
                                <div class="key-row">
                                    <div class="key-item">
                                        <kbd aria-label="Q key">Q</kbd>
                                        <span>Arm 1 Up</span>
                                    </div>
                                    <div class="key-item">
                                        <kbd aria-label="E key">E</kbd>
                                        <span>Arm 1 Down</span>
                                    </div>
                                </div>
                                <div class="key-row">
                                    <div class="key-item">
                                        <kbd aria-label="R key">R</kbd>
                                        <span>Arm 2 Up</span>
                                    </div>
                                    <div class="key-item">
                                        <kbd aria-label="F key">F</kbd>
                                        <span>Arm 2 Down</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="controls-help">
                        <p class="help-text">
                            <i class="fas fa-info-circle" aria-hidden="true"></i>
                            Hold multiple keys for combined movements. Press Space for emergency stop.
                        </p>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <!-- Configuration Modal -->
    <div id="configModal" class="modal" role="dialog" aria-labelledby="configModalTitle" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="configModalTitle">Robot Configuration</h2>
                <button class="close-modal" onclick="closeConfigModal()" aria-label="Close configuration">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="config-tabs" role="tablist">
                    <button class="tab-btn active" onclick="showTab('physical')" role="tab" aria-controls="physicalTab" aria-selected="true">Physical Parameters</button>
                    <button class="tab-btn" onclick="showTab('movement')" role="tab" aria-controls="movementTab" aria-selected="false">Movement Settings</button>
                    <button class="tab-btn" onclick="showTab('calibration')" role="tab" aria-controls="calibrationTab" aria-selected="false">Calibration</button>
                    <button class="tab-btn" onclick="showTab('advanced')" role="tab" aria-controls="advancedTab" aria-selected="false">Advanced</button>
                </div>

                <div id="physicalTab" class="tab-content active" role="tabpanel" aria-labelledby="physicalTabBtn">
                    <div class="config-group">
                        <h3>Robot Dimensions</h3>
                        <div class="config-row">
                            <label for="axleTrack">Axle Track (mm):</label>
                            <input type="number" id="axleTrack" value="112" step="0.1" min="50" max="300" class="config-input" aria-describedby="axleTrackHelp">
                            <small id="axleTrackHelp" class="help-text">Distance between wheel centers</small>
                        </div>
                        <div class="config-row">
                            <label for="wheelDiameter">Wheel Diameter (mm):</label>
                            <input type="number" id="wheelDiameter" value="56" step="0.1" min="20" max="100" class="config-input" aria-describedby="wheelDiameterHelp">
                            <small id="wheelDiameterHelp" class="help-text">Diameter of drive wheels</small>
                        </div>
                    </div>

                    <div class="config-group">
                        <h3>Motor Ports</h3>
                        <div class="config-row">
                            <label for="leftMotorPort">Left Motor Port:</label>
                            <select id="leftMotorPort" class="config-select" aria-describedby="leftMotorHelp">
                                <option value="A" selected>A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                            <small id="leftMotorHelp" class="help-text">Left drive motor port</small>
                        </div>
                        <div class="config-row">
                            <label for="rightMotorPort">Right Motor Port:</label>
                            <select id="rightMotorPort" class="config-select">
                                <option value="A">A</option>
                                <option value="B" selected>B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <label for="arm1MotorPort">Arm 1 Motor Port:</label>
                            <select id="arm1MotorPort" class="config-select">
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C" selected>C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <label for="arm2MotorPort">Arm 2 Motor Port:</label>
                            <select id="arm2MotorPort" class="config-select">
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D" selected>D</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="movementTab" class="tab-content" role="tabpanel">
                    <div class="config-group">
                        <h3>Speed Settings</h3>
                        <div class="config-row">
                            <label for="straightSpeed">Straight Speed (deg/s):</label>
                            <input type="number" id="straightSpeed" value="500" min="100" max="1000" class="config-input">
                        </div>
                        <div class="config-row">
                            <label for="straightAccel">Straight Acceleration (deg/s²):</label>
                            <input type="number" id="straightAccel" value="250" min="50" max="500" class="config-input">
                        </div>
                        <div class="config-row">
                            <label for="turnRate">Turn Rate (deg/s):</label>
                            <input type="number" id="turnRate" value="200" min="50" max="400" class="config-input">
                        </div>
                        <div class="config-row">
                            <label for="turnAccel">Turn Acceleration (deg/s²):</label>
                            <input type="number" id="turnAccel" value="300" min="100" max="600" class="config-input">
                        </div>
                    </div>
                </div>

                <div id="calibrationTab" class="tab-content" role="tabpanel">
                    <div class="config-group">
                        <h3>Calibration Control</h3>
                        <p class="calibration-info">
                            Calibration improves robot accuracy by measuring and compensating for hardware variations.
                        </p>
                        <button id="startCalibrationBtn" class="btn btn-warning">
                            <i class="fas fa-sync" aria-hidden="true"></i>
                            Start Calibration
                        </button>
                        <div id="calibrationProgress" class="progress-container hidden">
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill"></div>
                            </div>
                            <div id="calibrationStep" class="calibration-step">Starting calibration...</div>
                        </div>
                        <div id="calibrationResults" class="calibration-results hidden">
                            <h4>Calibration Results</h4>
                            <div id="calibrationData"></div>
                        </div>
                    </div>
                </div>

                <div id="advancedTab" class="tab-content" role="tabpanel">
                    <div class="config-group">
                        <h3>Advanced Settings</h3>
                        <div class="config-row">
                            <label for="commandTimeout">Command Timeout (ms):</label>
                            <input type="number" id="commandTimeout" value="1000" min="100" max="5000" class="config-input">
                        </div>
                        <div class="config-row">
                            <label for="batteryWarning">Battery Warning Level (%):</label>
                            <input type="number" id="batteryWarning" value="20" min="5" max="50" class="config-input">
                        </div>
                        <div class="config-row">
                            <label for="autoSave">Auto-save recordings:</label>
                            <input type="checkbox" id="autoSave" class="checkbox">
                        </div>
                        <div class="config-row">
                            <label for="debugMode">Debug Mode:</label>
                            <input type="checkbox" id="debugMode" class="checkbox">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="resetConfigToDefaults()">Reset to Defaults</button>
                <button class="btn btn-secondary" onclick="closeConfigModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveConfiguration()">Save Configuration</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <script src="app.js"></script>
</body>
</html>